<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LevelGuidz</title>
    <link rel="icon" type="image/png" href="img/favicon.png">
    <link rel="shortcut icon" type="image/png" href="img/favicon.png">
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/bootstrap-icons.min.css" rel="stylesheet"> <!-- Changed extension to .min.css -->
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand" href="./index.html">
          <img src="img/logo_dark.svg" alt="Logo" height="30" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link active" href="./news.html">News</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" id="coachingNavLink">Coaching</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Guides</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./contact.html">Contact</a>
            </li>
          </ul>
          <div class="d-flex">
            <div class="user-section">
              <!-- Login button shown when logged out -->
              <a class="btn btn-outline-light" href="./index.html#login" id="loginButton">Login</a>
              
              <!-- Username dropdown shown when logged in -->
              <div class="dropdown d-none" id="userDropdown">
                <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  <span id="usernamePlaceholder"></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-dark">
                  <li><a class="dropdown-item" href="./index.html#login" id="logoutBtn">Logout</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <div class="hero-banner position-relative">
        <div class="decorative-dots"></div>
        <div class="container h-100 d-flex align-items-center">
            <div class="hero-content text-center mx-auto" style="max-width: 800px;">
                <h1 class="display-4 fw-bold">Leading TFT Coaching Platform</h1>
                <p class="lead">Become a better gamer! Get TFT coaching to raise to Challenger tier!</p>
                
                <div class="steps-indicator mb-4" style="z-index: 2;">
                    <div class="steps-wrapper d-flex justify-content-center gap-5">
                        <div class="step-circle">
                            <span class="step-number">1</span>
                            <span class="step-text">Choose your game</span>
                        </div>
                        <div class="step-circle">
                            <span class="step-number">2</span>
                            <span class="step-text">Find your coach</span>
                        </div>
                        <div class="step-circle">
                            <span class="step-number">3</span>
                            <span class="step-text">Start Improving</span>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-center">
                    <a href="#" class="btn btn-hero-cta mt-5" id="chooseCoachBtn">
                        <span>Choose Your Coach</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right ms-2" viewBox="0 0 16 16">
                            <path d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <main class="container my-4">
        <section class="features-section py-5 position-relative">
            <div class="decorative-circle"></div>
            <div class="row g-4 features-flow">
                <div class="col-lg-4 position-relative">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="bi bi-controller"></i>
                        </div>
                        <h3>Choose Your Arena</h3>
                        <p>Select from our curated collection of popular competitive games. Each game features a dedicated team of elite coaches ready to guide you to victory.</p>
                    </div>
                </div>
                <div class="col-lg-4 position-relative">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="bi bi-search-heart"></i>
                        </div>
                        <h3>Match with Your Mentor</h3>
                        <p>Our sophisticated matching system analyzes your playstyle and goals to connect you with coaches who perfectly fit your needs and schedule.</p>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="bi bi-trophy"></i>
                        </div>
                        <h3>Master Your Game</h3>
                        <p>Transform your potential into professional-level performance. Our expert coaches will guide you through personalized training to achieve your competitive gaming goals.</p>
                        <a href="#" class="btn btn-primary mt-3">Start Now</a>
                    </div>
                </div>
            </div>
        </section>

        <section class="featured-coaches py-5 position-relative">
            <div class="decorative-dots"></div>
            <div class="decorative-circle"></div>
            <h2 class="text-center mb-2">Featured Coaches</h2>
            <p class="text-center text-muted mb-5">Learn from the best players in the industry</p>
            
            <div id="coachCarousel" class="carousel slide overflow-visible w-100" data-bs-ride="false">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#coachCarousel" data-bs-slide-to="0" class="active"></button>
                    <button type="button" data-bs-target="#coachCarousel" data-bs-slide-to="1"></button>
                </div>
                <div class="container-fluid px-0">
                    <div class="carousel-inner">
                        <!-- First Slide -->
                        <div class="carousel-item active">
                            <div class="row g-4 align-items-stretch">
                                <!-- Coach 1 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-1.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">Alex "Wiz"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">4.9</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 98%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">Top Rated</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-mortarboard"></i> Over 1000+ coaching sessions</li>
                                                <li><i class="bi bi-diagram-3"></i> Advanced strategy expert</li>
                                                <li><i class="bi bi-trophy"></i> Top 100 globally</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- Coach 2 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-2.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">Dan "EliteGuide"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">4.7</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 94%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">Expert</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-calendar-check"></i> Competitive player since 2018</li>
                                                <li><i class="bi bi-graph-up"></i> Meta analysis expert</li>
                                                <li><i class="bi bi-trophy"></i> Tournament champion</li>
                                            </ul>
                                        </div>
                                        
                                    </div>
                                </div>
                                <!-- Coach 3 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-3.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">Marcus "Strato"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">5.0</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 100%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">Pro Player</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-stars"></i> Professional esports player</li>
                                                <li><i class="bi bi-lightning"></i> Strategy optimization</li>
                                                <li><i class="bi bi-trophy"></i> Regional champion</li>
                                            </ul>
                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Second Slide -->
                        <div class="carousel-item">
                            <div class="row g-4 align-items-stretch">
                                <!-- Coach 4 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-4.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">Brian "Macro"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">4.8</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 96%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">RTS Specialist</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-controller"></i> Expert in real-time strategy</li>
                                                <li><i class="bi bi-graph-up"></i> Macro game analysis</li>
                                                <li><i class="bi bi-trophy"></i> ESL Champion</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- Coach 5 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-5.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">Michael "B-eye"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">4.6</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 92%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">FPS Expert</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-bullseye"></i> Precision aiming techniques</li>
                                                <li><i class="bi bi-shield"></i> Defensive strategies</li>
                                                <li><i class="bi bi-trophy"></i> Tournament finalist</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- Coach 6 -->
                                <div class="col-lg-4 d-flex">
                                    <div class="coach-card flex-grow-1">
                                        <img src="img/coach-6.jpg" alt="Coach Name" class="coach-image">
                                        <div class="coach-info">
                                            <div class="d-flex justify-content-between align-items-start mb-3">
                                                <div>
                                                    <h3 class="h5 mb-2">David "SpeedKing"</h3>
                                                    <div class="rating">
                                                        <div class="rating-score">4.9</div>
                                                        <div class="rating-bar">
                                                            <div class="rating-fill" style="width: 98%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="badge bg-primary">Racing Pro</span>
                                            </div>
                                            <ul class="coach-features">
                                                <li><i class="bi bi-speedometer2"></i> Racing simulation expert</li>
                                                <li><i class="bi bi-gear"></i> Vehicle setup mastery</li>
                                                <li><i class="bi bi-trophy"></i> Circuit champion</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="carousel-control-prev" type="button" data-bs-target="#coachCarousel" data-bs-slide="prev" style="top: 50%; transform: translateY(-50%); left: -50px;">
                    <span class="carousel-control-prev-icon"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#coachCarousel" data-bs-slide="next" style="top: 50%; transform: translateY(-50%); right: -50px;">
                    <span class="carousel-control-next-icon"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </section>

        <section class="how-it-works py-5 position-relative">
            <div class="decorative-dots"></div>
            <div class="decorative-circle"></div>
            <h2 class="text-center mb-5">How it Works</h2>
            
            <div class="row gy-5 align-items-center">
                <!-- Block 1 - Image Left -->
                <div class="col-lg-6">
                    <div class="auth-wrapper">
                        <div class="auth-flipper">
                            <!-- Login Form -->
                            <div class="auth-form front p-4">
                                <h4 class="text-center mb-4">Log In</h4>
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Phone Number</label>
                                        <input type="phone" class="form-control" placeholder="Enter your phone number">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Password</label>
                                        <div class="password-field">
                                            <input type="password" class="form-control" placeholder="Enter your password">
                                            <button type="button" class="password-toggle" aria-label="Toggle password visibility">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input" id="remember">
                                            <label class="form-check-label" for="remember">Remember me</label>
                                        </div>
                                        <a href="#" class="text-primary forgot-trigger">Forgot Password?</a>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 mb-3">Sign In</button>
                                    <p class="text-center mb-0">Don't have an account? <a href="#" class="text-primary flip-trigger">Sign Up</a></p>
                                </form>
                            </div>

                            <!-- Sign Up Form -->
                            <div class="auth-form back p-4" id="login">
                                <h4 class="text-center mb-4">Create Account</h4>
                                <form>
                                    <!-- Username and Phone in one line -->
                                    <div class="row mb-3">
                                        <div class="col-6">
                                            <label class="form-label">Username</label>
                                            <input type="text" class="form-control" placeholder="Choose a username">
                                        </div>
                                        <div class="col-6">
                                            <label class="form-label">Phone Number</label>
                                            <input type="phone" class="form-control" placeholder="Phone Number">
                                        </div>
                                    </div>
                                    <!-- Password fields in one line -->
                                    <div class="row mb-4">
                                        <div class="col-6">
                                            <label class="form-label">Password</label>
                                            <div class="password-field">
                                                <input type="password" class="form-control signup-password" placeholder="Create password">
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <label class="form-label">Confirm Password</label>
                                            <div class="password-field">
                                                <input type="password" class="form-control signup-password" placeholder="Confirm password">
                                                <button type="button" class="password-toggle" id="signup-password-toggle">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 mb-3">Create Account</button>
                                    <p class="text-center mb-0">Already have an account? <a href="#" class="text-primary flip-trigger">Sign In</a></p>
                                </form>
                            </div>

                            <!-- Forgot Password Form -->
                            <div class="auth-form forgot p-4 back">
                                <h4 class="text-center mb-4">Reset Password</h4>
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Phone Number</label>
                                        <input type="phone" class="form-control" placeholder="Enter your phone Number">
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 mb-3">Send Reset Link</button>
                                    <p class="text-center mb-0">
                                        <a href="#" class="text-primary back-to-login">Back to Sign In</a>
                                    </p>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="numbered-content">
                        <h3 class="mb-4">Start Your Gaming Journey</h3>
                        <div class="steps-list">
                            <div class="step-item">
                                <div class="d-flex align-items-center gap-3 mb-2">
                                    <span class="step-number">1</span>
                                    <h4 class="h6 mb-0">Upgrade your Membership to Premium</h4>
                                </div>
                                <p>Unlock the full potential of our platform with premium membership. Get priority access to top coaches, exclusive resources, and advanced features to accelerate your progress.</p>
                            </div>
                            <div class="step-item">
                                <div class="d-flex align-items-center gap-3 mb-2">
                                    <span class="step-number">2</span>
                                    <h4 class="h6 mb-0">Define games for yourself and choose your perfect coach</h4>
                                </div>
                                <p>Select your preferred games and explore our extensive roster of specialized coaches. Our platform helps you find the perfect mentor based on your skill level, goals, and playing style.</p>
                            </div>
                            <div class="step-item">
                                <div class="d-flex align-items-center gap-3 mb-2">
                                    <span class="step-number">3</span>
                                    <h4 class="h6 mb-0">Start your 1-1 unlimited session with a professional player</h4>
                                </div>
                                <p>Enjoy unlimited one-on-one coaching sessions with your chosen professional player. Get personalized attention, real-time feedback, and tailored strategies to maximize your improvement.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Block 2 - Image Left -->
                <div class="col-lg-6">
                    <div class="image-container shadow-lg">
                        <img src="img/progress.jpg" alt="Better Gamer" class="img-fluid">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="content-block">
                        <h3>
                            <span class="highlight-text">Level Up</span> Your Gaming Skills
                        </h3>
                        <div class="content-separator my-4"></div>
                        <p>Ready to transform your gaming passion into professional-level expertise? Whether you're aiming for tournament success or streaming stardom, our coaching platform is your gateway to excellence. With personalized guidance from top-tier coaches, you'll master advanced strategies and techniques that separate casual players from champions. Take control of your gaming future and unlock your full potential today.</p>
                    </div>
                </div>

                <!-- Block 3 - Image Right -->
                <div class="col-lg-6">
                    <div class="content-block">
                        <h3>
                            Learn from <span class="highlight-text">Elite Players</span>
                        </h3>
                        <div class="content-separator my-4"></div>
                        <p>Connect with championship-caliber coaches who've proven themselves at the highest levels of competitive gaming. Our rigorous selection process ensures you're learning from verified experts who excel at both playing and teaching. With real-time scheduling and personalized feedback, you'll get the focused attention needed to rapidly improve your gameplay and decision-making skills.</p>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="image-container shadow-lg">
                        <img src="img/esport.jpg" alt="Pro Players" class="img-fluid">
                    </div>
                </div>

                <!-- Block 4 - Image Left -->
                <div class="col-lg-6">
                    <div class="image-container shadow-lg">
                        <img src="img/how-4.jpg" alt="Results" class="img-fluid">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="content-block">
                        <h3>See <span class="highlight-text">Rapid Progress</span></h3>
                        <div class="content-separator my-4"></div>
                        <p>Experience measurable improvement in your gameplay from day one. Our structured coaching approach combines practical skills training with strategic insight, helping you climb ranks faster than solo practice. We're committed to your success, providing the tools and knowledge you need to compete at higher levels. Start your journey to mastery with coaches who understand what it takes to reach the top.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer py-5 mt-auto">
        <div class="container">
            <div class="row justify-content-between mb-4">
                <div class="col-lg-3 mb-4 mb-lg-0">
                    <a href="#" class="footer-brand d-inline-block mb-4">
                        <img src="img/logo_dark.svg" alt="Logo" height="30">
                    </a>
                    <p class="text-muted small mb-0">&copy; <script>document.write(new Date().getFullYear())</script> LevelGuidz.<br>All rights reserved.</p>
                </div>
                <div class="col-lg-6">
                    <div class="row">
                        <div class="col-6">
                            <h5 class="text-white mb-3">Company</h5>
                            <ul class="nav flex-column footer-nav">
                                <li class="nav-item"><a class="nav-link" href="./contact.html">Contact</a></li>
                                <li class="nav-item"><a class="nav-link" href="./faq.html">F.A.Q.</a></li>
                            </ul>
                        </div>
                        <div class="col-6">
                            <h5 class="text-white mb-3">Legal</h5>
                            <ul class="nav flex-column footer-nav">
                                <li class="nav-item"><a class="nav-link" href="./terms.html">Privacy Policy</a></li>
                                <li class="nav-item"><a class="nav-link" href="./terms.html">Terms of Service</a></li>
                                <li class="nav-item"><a class="nav-link" href="./refund.html">Refund Policy</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <p class="text-muted small text-center px-lg-5">All brand names, (registered) trademarks, images and product descriptions are the property of their legal owners and are neither sponsor nor partner of this promotion.</p>
        </div>
    </footer>

    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="authToast" class="toast" role="alert" data-bs-delay="3000">
            <div class="toast-body feature-card border-0">
                <span id="toastMessage"></span>
            </div>
        </div>
    </div>

    <a href="#" class="corner-button" aria-label="Scroll to top">
        <i class="bi bi-arrow-up"></i>
    </a>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="./js/main.js"></script>

    <script type="module">
      import { login, signup, forgotPassword } from './js/authApi.js';
      import { getCurrentUser } from './js/clientApi.js';

      function updateAuthUI() {
        const user = getCurrentUser();
        const loginBtn = document.getElementById('loginButton');
        const userDropdown = document.getElementById('userDropdown');
        const usernamePlaceholder = document.getElementById('usernamePlaceholder');
        if (user) {
          if (loginBtn) loginBtn.classList.add('d-none');
          if (userDropdown && usernamePlaceholder) {
            userDropdown.classList.remove('d-none');
            usernamePlaceholder.textContent = user.username;
          }
        } else {
          if (loginBtn) loginBtn.classList.remove('d-none');
          if (userDropdown) userDropdown.classList.add('d-none');
          if (usernamePlaceholder) usernamePlaceholder.textContent = '';
        }
      }

      document.addEventListener('DOMContentLoaded', function() {
        updateAuthUI();
        const authToast = new bootstrap.Toast(document.getElementById('authToast'));
        const showToast = (message, success = false) => {
          const toastMessage = document.getElementById('toastMessage');
          toastMessage.innerHTML = `
            <div class="d-flex align-items-center gap-2">
              <i class="bi ${success ? 'bi-check-circle-fill text-success' : 'bi-exclamation-circle-fill text-danger'}"></i>
              <span>${message}</span>
            </div>`;
          authToast.show();
        };

        // Login form handler
        document.querySelector('.auth-form.front form').addEventListener('submit', async (e) => {
          e.preventDefault();
          const form = e.target;
          const phone = form.querySelector('input[type="phone"]').value;
          const password = form.querySelector('input[type="password"]').value;
          try {
            const response = await login(phone, password);
            if (response.status === 'ok') {
              form.reset();
              showToast('Login successful!', true);
              updateAuthUI();
              // No redirect after login
            } else if (response.error) {
              showToast(response.error);
            } else {
              showToast('Login failed');
            }
          } catch (error) {
            showToast(error.message);
          }
        });

        // Signup form handler
        document.querySelector('.auth-form.back form').addEventListener('submit', async (e) => {
          e.preventDefault();
          const form = e.target;
          const username = form.querySelector('input[type="text"]').value;
          const phone = form.querySelector('input[type="phone"]').value;
          const password = form.querySelectorAll('.signup-password')[0].value;
          const confirmPassword = form.querySelectorAll('.signup-password')[1].value;
          if (password !== confirmPassword) {
            showToast('Passwords do not match');
            return;
          }
          try {
            const response = await signup(username, phone, password);
            if (response.status === 'ok') {
              form.reset();
              showToast('Account created successfully! Please login.', true);
              document.querySelector('.auth-flipper').classList.remove('flipped');
              setTimeout(updateAuthUI, 500);
            } else {
              throw new Error(response.error || 'Registration failed');
            }
          } catch (error) {
            showToast(error.message);
          }
        });

        // Logout handler
        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            localStorage.removeItem('user');
            updateAuthUI();
            window.location.href = './index.html';
          });
        }

        // Forgot password form handler
        document.querySelectorAll('.auth-form.forgot form').forEach(form => {
          form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const phone = form.querySelector('input[type="phone"]').value;
            try {
              const response = await forgotPassword(phone);
              if (response.status === 'ok') {
                form.reset();
                showToast('Password reset link has been sent to your phone.', true);
                document.querySelector('.auth-flipper').classList.remove('flipped');
              } else {
                throw new Error(response.error || 'Failed to send reset link');
              }
            } catch (error) {
              showToast(error.message);
            }
          });
        });

        document.querySelectorAll('.password-toggle:not(#signup-password-toggle)').forEach(toggle => {
          toggle.addEventListener('click', function() {
            const input = this.parentElement.querySelector('input');
            const icon = this.querySelector('i');
            input.type = input.type === 'password' ? 'text' : 'password';
            icon.classList.toggle('bi-eye');
            icon.classList.toggle('bi-eye-slash');
          });
        });

        document.querySelectorAll('.flip-trigger').forEach(trigger => {
          trigger.addEventListener('click', (e) => {
            e.preventDefault();
            document.querySelector('.auth-flipper').classList.toggle('flipped');
            document.querySelector('.auth-form.forgot').style.display = 'none';
            document.querySelector('.auth-form.back').style.display = '';
          });
        });

        document.querySelectorAll('.forgot-trigger').forEach(trigger => {
          trigger.addEventListener('click', function(e) {
            e.preventDefault();
            const flipper = document.querySelector('.auth-flipper');
            flipper.classList.add('flipped');
            document.querySelector('.auth-form.back').style.display = 'none';
            document.querySelector('.auth-form.forgot').style.display = 'block';
          });
        });

        document.querySelectorAll('.back-to-login').forEach(trigger => {
          trigger.addEventListener('click', function(e) {
            e.preventDefault();
            document.querySelector('.auth-flipper').classList.remove('flipped');
            document.querySelector('.auth-form.forgot').style.display = 'none';
            document.querySelector('.auth-form.back').style.display = '';
          });
        });
      });
    </script>

    <script type="module">
      import { initCoachSelectorModal, showCoachSelectorModal } from './js/coachSelector.js';
      document.addEventListener('DOMContentLoaded', function() {
        initCoachSelectorModal();
        // Nav link
        const coachingLink = document.getElementById('coachingNavLink');
        if (coachingLink) {
          coachingLink.addEventListener('click', function(e) {
            e.preventDefault();
            showCoachSelectorModal();
          });
        }
        // Hero CTA button
        const chooseCoachBtn = document.getElementById('chooseCoachBtn');
        if (chooseCoachBtn) {
          chooseCoachBtn.addEventListener('click', function(e) {
            e.preventDefault();
            showCoachSelectorModal();
          });
        }

        // --- Auth UI State Management ---
        function updateAuthUI() {
          const loginButton = document.getElementById('loginButton');
          const userDropdown = document.getElementById('userDropdown');
          const usernamePlaceholder = document.getElementById('usernamePlaceholder');
          // Example: check localStorage for user info (adjust as needed for your auth system)
          const user = JSON.parse(localStorage.getItem('user'));
          if (user && user.username) {
            loginButton.classList.add('d-none');
            userDropdown.classList.remove('d-none');
            usernamePlaceholder.textContent = user.username;
          } else {
            loginButton.classList.remove('d-none');
            userDropdown.classList.add('d-none');
            usernamePlaceholder.textContent = '';
          }
        }
        updateAuthUI();
        // Listen for logout
        const logoutBtn = document.getElementById('logoutBtn');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', function(e) {
            e.preventDefault();
            localStorage.removeItem('user');
            updateAuthUI();
            window.location.href = './index.html';
          });
        }
        // Listen for login/signup success (optional: use a custom event or poll localStorage)
        window.addEventListener('storage', function(e) {
          if (e.key === 'user') updateAuthUI();
        });
        // Optionally, expose updateAuthUI globally for other scripts
        window.updateAuthUI = updateAuthUI;
      });
    </script>
</body>
</html>
